<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layer/theme/default/layer.css">

    <script src="/layui/jquery-3.2.1.js"></script>
    <script src="/layer/layer.js"></script>

    <script src="/layui/layui.all.js"></script>
    <script src="/js/principalMoney.js"></script>
</head>
<body class="layui-layout-body">
<div class="layui-tab layui-tab-card" lay-filter="demo">
    <ul class="layui-tab-title">
        <li class="layui-this" lay-id="1">正常保证金</li>
        <li lay-id="2">异常保证金</li>
    </ul>
    <div class="layui-tab-content" style="height: 100px;">
        <div class="layui-tab-item layui-show">
            <div class="layui-row" id="layerDemo" style="margin-top: 40px">
                <form class="layui-form layui-form-pane" lay-filter="formDemo">
                    <div class="layui-form-item">
                        <label class="layui-form-label">项目名称</label>
                        <div class="layui-input-inline">
                            <input type="text" autocomplete="off" name="itemName" placeholder="项目名称"
                                   class="layui-input" >
                        </div>
                       <!-- <label class="layui-form-label">缴费状态</label>
                        <div class="layui-input-inline" >

                            <select name="depositPayStatus" class="layui-select" style="width: 150px;height: 30px">11
                                <option value="">-请选择-</option>
                                <option value="2" name="">已缴</option>
                                <option value="1">未缴</option>
                            </select>
                        </div>-->
                      <!--  <label class="layui-form-label">退款状态</label>
                        <div class="layui-input-inline" >

                            <select name="isReturn" class="layui-select" style="width: 150px;height: 30px">
                                <option value="">-请选择-</option>
                                <option value="2" name="">已退</option>
                                <option value="1">未退</option>
                            </select>
                        </div>-->
                        <div class="layui-input-inline" style="width: 100px">
                            <button class="layui-btn" style="width: 100%" type="button"
                                    lay-submit lay-filter="selectone">查询
                            </button>
                        </div>

                    </div>

                </form>
            </div>
            <table class="layui-hide" lay-filter="normalTab" id="normalTab"></table>
        </div>
        <div class="layui-tab-item">
            <div class="layui-row" id="layerDemo1" style="margin-top: 40px">
                <form class="layui-form layui-form-pane" lay-filter="formDemo">
                    <div class="layui-form-item">
                        <label class="layui-form-label">项目名称</label>
                        <div class="layui-input-inline">
                            <input type="text" autocomplete="off" name="itemName" placeholder="项目名称"
                                   class="layui-input" >
                        </div>

                        <div class="layui-input-inline" style="width: 100px">
                            <button class="layui-btn" style="width: 100%" type="button"
                                    lay-submit lay-filter="selecttwo">查询
                            </button>
                        </div>

                    </div>

                </form>
            </div>
            <table class="layui-hide" lay-filter="anormalTab" id="anormalTab"></table>
        </div>
    </div>
</div>

<div hidden  id="addCouponDiv">
    <form id="addCoupon" class="layui-form layui-form-pane" lay-filter="formDemo1">
        <input hidden name="couponNewId">
        <div style="width:410px;float:left;margin-left: 50px" >
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">项目名称</label>
                    <div class="layui-input-block">
                        <input type="text" style="width: 130px" name="itemName" id="itemName" autocomplete="off" class="layui-input">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">项目编号</label>
                    <div class="layui-input-block">
                        <input type="text" style="width: 130px" name="itemCode" id="dateend1" autocomplete="off" class="layui-input">

                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">项目类型</label>
                    <div class="layui-input-block" style="width: 130px">
                        <select name="itemType" >
                            <option value=""></option>
                            <option value="1" name="">产权交易</option>
                            <option value="2">土地租赁</option>
                            <option value="3">房屋租赁</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">标的名称</label>
                    <div class="layui-input-block">
                        <input type="text" autocomplete="off" name="objectName"
                               style="width: 130px"  placeholder="张" class="layui-input">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">竞买人</label>
                    <div class="layui-input-block" style="width: 200px">
                        <input type="text" autocomplete="off" name="bidName" class="layui-input">
                    </div>
                </div>
            </div>

        </div>
        <div style="float:left;margin-left: 20px">
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">金额</label>
                    <div class="layui-input-block">
                        <input type="text" autocomplete="off" name="money" placeholder=""
                               style="width: 130px" class="layui-input">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">缴费状态</label>
                    <div class="layui-input-block" style="width: 130px">
                        <select name="depositPayStatus" style="width: 200px" >
                            <option value=""></option>
                            <option value="1" name="">未缴</option>
                            <option value="2">已缴</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">缴费时间</label>
                    <div class="layui-input-block">
                        <input type="text" autocomplete="off" name="depositTime"
                               style="width: 180px" placeholder="" class="layui-input">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">退费状态</label>
                    <div class="layui-input-block" style="width: 130px">
                        <select name="isReturn" >
                            <option value=""></option>
                            <option value="1" name="">未退</option>
                            <option value="2">已退</option>
                            <option value="3">退费失败</option>
                        </select>

                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <label class="layui-form-label">退费时间</label>
                    <div class="layui-input-block" style="width: 130px">
                        <input type="text" autocomplete="off" name="backTime"
                               style="width: 180px" placeholder="" class="layui-input">
                    </div>
                </div>
            </div>

        </div>
    </form>
</div>



</body>
<script>
    layui.use(['element', 'table','form'], function () {
        var element = layui.element;
        var table = layui.table;
        var form = layui.form;

        var active = {
            tabChange:function () {
                element.tabChange('demo','2')
            },confirmTrans: function () {
                //配置一个透明的询问框
                layer.msg('切换？', {
                    time: 20000, //20s后自动关闭
                    btn: [ '知道了']
                });
            }
        };

        var movie1={
            itemName:"",
            depositPayStatus:"",
            isReturn:""
        }
        form.on('submit(selectone)',function (data) {
            movie1.itemName = data.field.itemName;
            movie1.depositPayStatus = data.field.depositPayStatus;
            movie1.isReturn = data.field.isReturn;

            table1(movie1);
        });
        table1(movie1);

        function table1(movie1){
            table.render({
                elem: '#normalTab'
                , url: '/money/normalMoney'
                , method: "post"
                , where: movie1
                , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
                , cols: [
                    [
                         {field: 'itemCode', width: 150, title: '项目编号'}
                        , {field: 'itemName', width: 150, title: '项目名称'}
                        , {field: 'itemType', width: 150, title: '项目类型',templet: function (d) {
                            if (d.itemType == '1') {
                                return "产权交易";
                            }else
                            if (d.itemType == '2') {
                                return "土地租赁";
                            }else
                            if (d.itemStatus == '3') {
                                return "房屋租赁";
                            }
                        }}
                        , {field: 'objectName', width: 150, title: '标的名称'}
                        , {field: 'bidName', width: 150, title: '竞买人'}
                        , {field: 'money', width: 150, title: '金额'}
                        , {field: 'depositPayStatus', width: 150, title: '缴费状态', templet: function (d) {
                            if (d.depositPayStatus == '1') {
                                return "未缴";
                            }
                            ;
                            if (d.depositPayStatus == '2') {
                                return "已缴";
                            };
                        }} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                        , {field: 'depositTime', width: 200, title: '缴费时间'}
                        , {field: 'isReturn', width: 150, title: '退费状态', templet: function (d) {
                            if (d.isReturn == '1') {
                                return "未退";
                            }
                            ;
                            if (d.isReturn == '2') {
                                return "已退";
                            };
                        }}
                        , {field: 'backTime', width: 200, title: '退费时间'}


                    ]
                ]
            })
            table.on('row(normalTab)', function(obj){
                form.val('formDemo1', {
                    "itemName": obj.data.itemName,
                    "depositPayStatus":obj.data.depositPayStatus,
                    "itemCode": obj.data.itemCode,
                    "itemType": obj.data.itemType,
                    "objectName": obj.data.objectName,
                    "bidName":obj.data.bidName,
                    "money": obj.data.money,
                    "depositTime": obj.data.depositTime,
                    "backTime": obj.data.backTime,
                    "isReturn":obj.data.isReturn,
                });

                layer.open({
                    type: 1
                    ,title: "查看保证金明细" //不显示标题栏
                    ,closeBtn: false
                    ,area: ['50%','50%']
                    ,shade: 0
                    ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                    ,btn: ['关闭']
                    ,btnAlign: 'c'
                    ,moveType: 1 //拖拽模式，0或者1
                    ,content: $("#addCouponDiv")

                });
            });
        }


        var movie2={
            itemName:"",
            depositPayStatus:"",
            isReturn:""
        }
        form.on('submit(selecttwo)',function (data) {
            movie2.itemName = data.field.itemName;
            movie2.depositPayStatus = data.field.depositPayStatus;
            movie2.isReturn = data.field.isReturn;

            table2(movie2);
        });
        table2(movie2);

        function table2(movie2){
            table.render({
                elem: '#anormalTab'
                , url: '/money/anormalMoney'
                , method: "post"
                , where: movie2
                , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
                , cols: [
                    [
                        {field: 'applyId', hide: true}
                        , {field: 'itemCode', width: 150, title: '项目编号'}
                        , {field: 'itemName', width: 150, title: '项目名称'}
                        , {field: 'itemType', width: 150, title: '项目类型',templet: function (d) {
                            if (d.itemType == '1') {
                                return "产权交易";
                            }else
                            if (d.itemType == '2') {
                                return "土地租赁";
                            }else
                            if (d.itemStatus == '3') {
                                return "房屋租赁";
                            }
                        }}
                        , {field: 'objectName', width: 150, title: '标的名称'}
                        , {field: 'bidName', width: 150, title: '竞买人'}
                        , {field: 'money', width: 150, title: '金额'}
                        , {field: 'depositPayStatus', width: 150, title: '缴费状态', templet: function (d) {
                            if (d.depositPayStatus == '1') {
                                return "未缴";
                            }
                            ;
                            if (d.depositPayStatus == '2') {
                                return "已缴";
                            };
                        }} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                        , {field: 'depositTime', width: 200, title: '缴费时间'}
                        , {field: 'isReturn', width: 150, title: '退费状态', templet: function (d) {
                            if (d.isReturn == '1') {
                                return "未退";
                            };
                            if (d.isReturn == '3') {
                                return "<p style='color: red'>退费失败</p>";
                            }
                            ;
                            if (d.isReturn == '2') {
                                return "已退";
                            };
                        }}
                        , {field: 'backTime', width: 200, title: '退费时间'}


                    ]
                ]
            })

            table.on('row(anormalTab)', function(obj){
                form.val('formDemo1', {
                    "itemName": obj.data.itemName,
                    "depositPayStatus":obj.data.depositPayStatus,
                    "itemCode": obj.data.itemCode,
                    "itemType": obj.data.itemType,
                    "objectName": obj.data.objectName,
                    "bidName":obj.data.bidName,
                    "money": obj.data.money,
                    "depositTime": obj.data.depositTime,
                    "backTime": obj.data.backTime,
                    "isReturn":obj.data.isReturn,
                });

                layer.open({
                    type: 1
                    ,title: "查看保证金明细" //不显示标题栏
                    ,closeBtn: false
                    ,area: ['50%','50%']
                    ,shade: 0
                    ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                    ,btn: ['关闭']
                    ,btnAlign: 'c'
                    ,moveType: 1 //拖拽模式，0或者1
                    ,content: $("#addCouponDiv")

                });
            });
        }


    });
</script>

</html>